

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>API Reference &mdash; teiphy  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=5929fcd5"></script>
      <script src="_static/doctools.js?v=9a2dae69"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="_static/copybutton.js?v=f281be69"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Command Line Interface Reference" href="cli.html" />
    <link rel="prev" title="Example" href="example.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            teiphy
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced.html">Advanced Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="example.html">Example</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#collation">Collation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#teiphy.Collation"><code class="docutils literal notranslate"><span class="pre">Collation</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Collation.manuscript_suffixes"><code class="docutils literal notranslate"><span class="pre">Collation.manuscript_suffixes</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Collation.trivial_reading_types"><code class="docutils literal notranslate"><span class="pre">Collation.trivial_reading_types</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Collation.missing_reading_types"><code class="docutils literal notranslate"><span class="pre">Collation.missing_reading_types</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Collation.fill_corrector_lacunae"><code class="docutils literal notranslate"><span class="pre">Collation.fill_corrector_lacunae</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Collation.fragmentary_threshold"><code class="docutils literal notranslate"><span class="pre">Collation.fragmentary_threshold</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Collation.witnesses"><code class="docutils literal notranslate"><span class="pre">Collation.witnesses</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Collation.witness_index_by_id"><code class="docutils literal notranslate"><span class="pre">Collation.witness_index_by_id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Collation.variation_units"><code class="docutils literal notranslate"><span class="pre">Collation.variation_units</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Collation.readings_by_witness"><code class="docutils literal notranslate"><span class="pre">Collation.readings_by_witness</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Collation.substantive_variation_unit_ids"><code class="docutils literal notranslate"><span class="pre">Collation.substantive_variation_unit_ids</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Collation.substantive_variation_unit_reading_tuples"><code class="docutils literal notranslate"><span class="pre">Collation.substantive_variation_unit_reading_tuples</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Collation.verbose"><code class="docutils literal notranslate"><span class="pre">Collation.verbose</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Collation.filter_fragmentary_witnesses"><code class="docutils literal notranslate"><span class="pre">Collation.filter_fragmentary_witnesses()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Collation.get_base_wit"><code class="docutils literal notranslate"><span class="pre">Collation.get_base_wit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Collation.get_beast_code_map_for_unit"><code class="docutils literal notranslate"><span class="pre">Collation.get_beast_code_map_for_unit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Collation.get_beast_date_map"><code class="docutils literal notranslate"><span class="pre">Collation.get_beast_date_map()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Collation.get_beast_equilibrium_frequencies_for_unit"><code class="docutils literal notranslate"><span class="pre">Collation.get_beast_equilibrium_frequencies_for_unit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Collation.get_beast_origin_span"><code class="docutils literal notranslate"><span class="pre">Collation.get_beast_origin_span()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Collation.get_beast_root_frequencies_for_unit"><code class="docutils literal notranslate"><span class="pre">Collation.get_beast_root_frequencies_for_unit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Collation.get_beast_symbols"><code class="docutils literal notranslate"><span class="pre">Collation.get_beast_symbols()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Collation.get_fasta_symbols"><code class="docutils literal notranslate"><span class="pre">Collation.get_fasta_symbols()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Collation.get_hennig86_symbols"><code class="docutils literal notranslate"><span class="pre">Collation.get_hennig86_symbols()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Collation.get_nexus_symbols"><code class="docutils literal notranslate"><span class="pre">Collation.get_nexus_symbols()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Collation.get_phylip_symbols"><code class="docutils literal notranslate"><span class="pre">Collation.get_phylip_symbols()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Collation.get_readings_by_witness_for_unit"><code class="docutils literal notranslate"><span class="pre">Collation.get_readings_by_witness_for_unit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Collation.get_stemma_symbols"><code class="docutils literal notranslate"><span class="pre">Collation.get_stemma_symbols()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Collation.get_tip_date_range"><code class="docutils literal notranslate"><span class="pre">Collation.get_tip_date_range()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Collation.parse_apps"><code class="docutils literal notranslate"><span class="pre">Collation.parse_apps()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Collation.parse_intrinsic_odds"><code class="docutils literal notranslate"><span class="pre">Collation.parse_intrinsic_odds()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Collation.parse_list_wit"><code class="docutils literal notranslate"><span class="pre">Collation.parse_list_wit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Collation.parse_origin_date_range"><code class="docutils literal notranslate"><span class="pre">Collation.parse_origin_date_range()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Collation.parse_readings_by_witness"><code class="docutils literal notranslate"><span class="pre">Collation.parse_readings_by_witness()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Collation.parse_transcriptional_rates"><code class="docutils literal notranslate"><span class="pre">Collation.parse_transcriptional_rates()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Collation.parse_weights"><code class="docutils literal notranslate"><span class="pre">Collation.parse_weights()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Collation.to_beast"><code class="docutils literal notranslate"><span class="pre">Collation.to_beast()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Collation.to_csv"><code class="docutils literal notranslate"><span class="pre">Collation.to_csv()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Collation.to_dataframe"><code class="docutils literal notranslate"><span class="pre">Collation.to_dataframe()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Collation.to_distance_matrix"><code class="docutils literal notranslate"><span class="pre">Collation.to_distance_matrix()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Collation.to_excel"><code class="docutils literal notranslate"><span class="pre">Collation.to_excel()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Collation.to_fasta"><code class="docutils literal notranslate"><span class="pre">Collation.to_fasta()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Collation.to_file"><code class="docutils literal notranslate"><span class="pre">Collation.to_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Collation.to_hennig86"><code class="docutils literal notranslate"><span class="pre">Collation.to_hennig86()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Collation.to_idf_matrix"><code class="docutils literal notranslate"><span class="pre">Collation.to_idf_matrix()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Collation.to_long_table"><code class="docutils literal notranslate"><span class="pre">Collation.to_long_table()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Collation.to_nexus"><code class="docutils literal notranslate"><span class="pre">Collation.to_nexus()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Collation.to_nexus_table"><code class="docutils literal notranslate"><span class="pre">Collation.to_nexus_table()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Collation.to_numpy"><code class="docutils literal notranslate"><span class="pre">Collation.to_numpy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Collation.to_phylip"><code class="docutils literal notranslate"><span class="pre">Collation.to_phylip()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Collation.to_phylip_matrix"><code class="docutils literal notranslate"><span class="pre">Collation.to_phylip_matrix()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Collation.to_similarity_matrix"><code class="docutils literal notranslate"><span class="pre">Collation.to_similarity_matrix()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Collation.to_stemma"><code class="docutils literal notranslate"><span class="pre">Collation.to_stemma()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Collation.update_origin_date_range_from_witness_date_ranges"><code class="docutils literal notranslate"><span class="pre">Collation.update_origin_date_range_from_witness_date_ranges()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Collation.update_witness_date_ranges_from_dates_file"><code class="docutils literal notranslate"><span class="pre">Collation.update_witness_date_ranges_from_dates_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Collation.update_witness_date_ranges_from_origin_date_range"><code class="docutils literal notranslate"><span class="pre">Collation.update_witness_date_ranges_from_origin_date_range()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Collation.validate_intrinsic_relations"><code class="docutils literal notranslate"><span class="pre">Collation.validate_intrinsic_relations()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Collation.validate_wits"><code class="docutils literal notranslate"><span class="pre">Collation.validate_wits()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#variation-unit">Variation Unit</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#teiphy.VariationUnit"><code class="docutils literal notranslate"><span class="pre">VariationUnit</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.VariationUnit.id"><code class="docutils literal notranslate"><span class="pre">VariationUnit.id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.VariationUnit.readings"><code class="docutils literal notranslate"><span class="pre">VariationUnit.readings</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.VariationUnit.intrinsic_relations"><code class="docutils literal notranslate"><span class="pre">VariationUnit.intrinsic_relations</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.VariationUnit.transcriptional_relations"><code class="docutils literal notranslate"><span class="pre">VariationUnit.transcriptional_relations</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.VariationUnit.parse"><code class="docutils literal notranslate"><span class="pre">VariationUnit.parse()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#witness">Witness</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#teiphy.Witness"><code class="docutils literal notranslate"><span class="pre">Witness</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Witness.id"><code class="docutils literal notranslate"><span class="pre">Witness.id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Witness.type"><code class="docutils literal notranslate"><span class="pre">Witness.type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Witness.date_range"><code class="docutils literal notranslate"><span class="pre">Witness.date_range</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#reading">Reading</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#teiphy.Reading"><code class="docutils literal notranslate"><span class="pre">Reading</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Reading.id"><code class="docutils literal notranslate"><span class="pre">Reading.id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Reading.type"><code class="docutils literal notranslate"><span class="pre">Reading.type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Reading.text"><code class="docutils literal notranslate"><span class="pre">Reading.text</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Reading.wits"><code class="docutils literal notranslate"><span class="pre">Reading.wits</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Reading.targets"><code class="docutils literal notranslate"><span class="pre">Reading.targets</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Reading.certainties"><code class="docutils literal notranslate"><span class="pre">Reading.certainties</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#teiphy.Reading.parse"><code class="docutils literal notranslate"><span class="pre">Reading.parse()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">Command Line Interface Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="credits.html">Credits</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">teiphy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">API Reference</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/reference.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="api-reference">
<h1>API Reference<a class="headerlink" href="#api-reference" title="Link to this heading"></a></h1>
<section id="collation">
<h2>Collation<a class="headerlink" href="#collation" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="teiphy.Collation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">teiphy.</span></span><span class="sig-name descname"><span class="pre">Collation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xml</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ElementTree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">manuscript_suffixes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trivial_reading_types</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">missing_reading_types</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_corrector_lacunae</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fragmentary_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dates_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#teiphy.Collation" title="Link to this definition"></a></dt>
<dd><p>Base class for storing TEI XML collation data internally.</p>
<p>This corresponds to the entire XML tree, rooted at the TEI element of the collation.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="teiphy.Collation.manuscript_suffixes">
<span class="sig-name descname"><span class="pre">manuscript_suffixes</span></span><a class="headerlink" href="#teiphy.Collation.manuscript_suffixes" title="Link to this definition"></a></dt>
<dd><p>A list of suffixes used to distinguish manuscript subwitnesses like first hands, correctors, main texts, alternate texts, and multiple attestations from their base witnesses.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="teiphy.Collation.trivial_reading_types">
<span class="sig-name descname"><span class="pre">trivial_reading_types</span></span><a class="headerlink" href="#teiphy.Collation.trivial_reading_types" title="Link to this definition"></a></dt>
<dd><p>A set of reading types (e.g., “reconstructed”, “defective”, “orthographic”, “subreading”) whose readings should be collapsed under the previous substantive reading.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="teiphy.Collation.missing_reading_types">
<span class="sig-name descname"><span class="pre">missing_reading_types</span></span><a class="headerlink" href="#teiphy.Collation.missing_reading_types" title="Link to this definition"></a></dt>
<dd><p>A set of reading types (e.g., “lac”, “overlap”) whose readings should be treated as missing data.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="teiphy.Collation.fill_corrector_lacunae">
<span class="sig-name descname"><span class="pre">fill_corrector_lacunae</span></span><a class="headerlink" href="#teiphy.Collation.fill_corrector_lacunae" title="Link to this definition"></a></dt>
<dd><p>A boolean flag indicating whether or not to fill “lacunae” in witnesses with type “corrector”.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="teiphy.Collation.fragmentary_threshold">
<span class="sig-name descname"><span class="pre">fragmentary_threshold</span></span><a class="headerlink" href="#teiphy.Collation.fragmentary_threshold" title="Link to this definition"></a></dt>
<dd><p>A float representing the proportion such that all witnesses extant at fewer than this proportion of variation units are filtered out of the collation.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="teiphy.Collation.witnesses">
<span class="sig-name descname"><span class="pre">witnesses</span></span><a class="headerlink" href="#teiphy.Collation.witnesses" title="Link to this definition"></a></dt>
<dd><p>A list of Witness instances contained in this Collation.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="teiphy.Collation.witness_index_by_id">
<span class="sig-name descname"><span class="pre">witness_index_by_id</span></span><a class="headerlink" href="#teiphy.Collation.witness_index_by_id" title="Link to this definition"></a></dt>
<dd><p>A dictionary mapping base witness ID strings to their int indices in the witnesses list.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="teiphy.Collation.variation_units">
<span class="sig-name descname"><span class="pre">variation_units</span></span><a class="headerlink" href="#teiphy.Collation.variation_units" title="Link to this definition"></a></dt>
<dd><p>A list of VariationUnit instances contained in this Collation.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="teiphy.Collation.readings_by_witness">
<span class="sig-name descname"><span class="pre">readings_by_witness</span></span><a class="headerlink" href="#teiphy.Collation.readings_by_witness" title="Link to this definition"></a></dt>
<dd><p>A dictionary mapping base witness ID strings to lists of reading support coefficients for all units (with at least two substantive readings).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="teiphy.Collation.substantive_variation_unit_ids">
<span class="sig-name descname"><span class="pre">substantive_variation_unit_ids</span></span><a class="headerlink" href="#teiphy.Collation.substantive_variation_unit_ids" title="Link to this definition"></a></dt>
<dd><p>A list of ID strings for variation units with two or more substantive readings.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="teiphy.Collation.substantive_variation_unit_reading_tuples">
<span class="sig-name descname"><span class="pre">substantive_variation_unit_reading_tuples</span></span><a class="headerlink" href="#teiphy.Collation.substantive_variation_unit_reading_tuples" title="Link to this definition"></a></dt>
<dd><p>A list of (variation unit ID, reading ID) tuples for substantive readings.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="teiphy.Collation.verbose">
<span class="sig-name descname"><span class="pre">verbose</span></span><a class="headerlink" href="#teiphy.Collation.verbose" title="Link to this definition"></a></dt>
<dd><p>A boolean flag indicating whether or not to print timing and debugging details for the user.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="teiphy.Collation.filter_fragmentary_witnesses">
<span class="sig-name descname"><span class="pre">filter_fragmentary_witnesses</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xml</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#teiphy.Collation.filter_fragmentary_witnesses" title="Link to this definition"></a></dt>
<dd><p>Filters the original witness list and readings by witness dictionary to exclude witnesses whose proportions of extant passages fall below the fragmentary readings threshold.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="teiphy.Collation.get_base_wit">
<span class="sig-name descname"><span class="pre">get_base_wit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#teiphy.Collation.get_base_wit" title="Link to this definition"></a></dt>
<dd><p>Given a witness siglum, strips of the specified manuscript suffixes until the siglum matches one in the witness list or until no more suffixes can be stripped.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>wit</strong> – A string representing a witness siglum, potentially including suffixes to be stripped.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="teiphy.Collation.get_beast_code_map_for_unit">
<span class="sig-name descname"><span class="pre">get_beast_code_map_for_unit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">symbols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">missing_symbol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vu_ind</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#teiphy.Collation.get_beast_code_map_for_unit" title="Link to this definition"></a></dt>
<dd><p>Returns a string containing state/reading code mappings in BEAST format using the given single-state and missing state symbols for the character/variation unit at the given index.
If the variation unit at the given index is a singleton unit (i.e., if it has only one substantive reading), then a code for a dummy state will be included.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>vu_ind</strong> – An integer index for the desired unit.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A string containing comma-separated code mappings.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="teiphy.Collation.get_beast_date_map">
<span class="sig-name descname"><span class="pre">get_beast_date_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">taxlabels</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#teiphy.Collation.get_beast_date_map" title="Link to this definition"></a></dt>
<dd><p>Returns a string representing witness-to-date mappings in BEAST format.</p>
<p>Since this format requires single dates as opposed to date ranges,
witnesses with closed date ranges will be mapped to the average of their lower and upper bounds,
and witnesses with open date ranges will not be mapped.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>taxlabels</strong> – A list of slugified taxon labels.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A string containing comma-separated date calibrations of the form witness_id=date.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="teiphy.Collation.get_beast_equilibrium_frequencies_for_unit">
<span class="sig-name descname"><span class="pre">get_beast_equilibrium_frequencies_for_unit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vu_ind</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#teiphy.Collation.get_beast_equilibrium_frequencies_for_unit" title="Link to this definition"></a></dt>
<dd><p>Returns a string containing state/reading equilibrium frequencies in BEAST format for the character/variation unit at the given index.
Since the equilibrium frequencies are not used with the substitution models, the equilibrium frequencies simply correspond to a uniform distribution over the states.
If the variation unit at the given index is a singleton unit (i.e., if it has only one substantive reading), then an equilibrium frequency of 0 will be added for a dummy state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>vu_ind</strong> – An integer index for the desired unit.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A string containing space-separated equilibrium frequencies.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="teiphy.Collation.get_beast_origin_span">
<span class="sig-name descname"><span class="pre">get_beast_origin_span</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tip_date_range</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#teiphy.Collation.get_beast_origin_span" title="Link to this definition"></a></dt>
<dd><p>Returns a tuple containing the lower and upper bounds for the height of the origin of the Birth-Death Skyline model.
The upper bound on the height of the tree is the difference between the latest tip date
and the lower bound on the date of the original work, if both are defined;
otherwise, it is left undefined.
The lower bound on the height of the tree is the difference between the latest tip date
and the upper bound on the date of the original work, if both are defined;
otherwise, it is the difference between the earliest tip date and the latest, if both are defined.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tip_date_range</strong> – A tuple containing the earliest and latest possible tip dates.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing lower and upper bounds on the origin height for the Birth-Death Skyline model.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="teiphy.Collation.get_beast_root_frequencies_for_unit">
<span class="sig-name descname"><span class="pre">get_beast_root_frequencies_for_unit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vu_ind</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#teiphy.Collation.get_beast_root_frequencies_for_unit" title="Link to this definition"></a></dt>
<dd><p>Returns a string containing state/reading root frequencies in BEAST format for the character/variation unit at the given index.
The root frequencies are calculated from the intrinsic odds at this unit.
If the variation unit at the given index is a singleton unit (i.e., if it has only one substantive reading), then a root frequency of 0 will be added for a dummy state.
If no intrinsic odds are specified, then a uniform distribution over all states is assumed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>vu_ind</strong> – An integer index for the desired unit.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A string containing space-separated root frequencies.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="teiphy.Collation.get_beast_symbols">
<span class="sig-name descname"><span class="pre">get_beast_symbols</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#teiphy.Collation.get_beast_symbols" title="Link to this definition"></a></dt>
<dd><p>Returns a list of one-character symbols needed to represent the states of all substantive readings in BEAST format.</p>
<p>The number of symbols equals the maximum number of substantive readings at any variation unit.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A list of individual characters representing states in readings.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="teiphy.Collation.get_fasta_symbols">
<span class="sig-name descname"><span class="pre">get_fasta_symbols</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#teiphy.Collation.get_fasta_symbols" title="Link to this definition"></a></dt>
<dd><p>Returns a list of one-character symbols needed to represent the states of all substantive readings in FASTA format.</p>
<p>The number of symbols equals the maximum number of substantive readings at any variation unit.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A list of individual characters representing states in readings.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="teiphy.Collation.get_hennig86_symbols">
<span class="sig-name descname"><span class="pre">get_hennig86_symbols</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#teiphy.Collation.get_hennig86_symbols" title="Link to this definition"></a></dt>
<dd><p>Returns a list of one-character symbols needed to represent the states of all substantive readings in Hennig86 format.</p>
<p>The number of symbols equals the maximum number of substantive readings at any variation unit.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A list of individual characters representing states in readings.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="teiphy.Collation.get_nexus_symbols">
<span class="sig-name descname"><span class="pre">get_nexus_symbols</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#teiphy.Collation.get_nexus_symbols" title="Link to this definition"></a></dt>
<dd><p>Returns a list of one-character symbols needed to represent the states of all substantive readings in NEXUS.</p>
<p>The number of symbols equals the maximum number of substantive readings at any variation unit.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A list of individual characters representing states in readings.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="teiphy.Collation.get_phylip_symbols">
<span class="sig-name descname"><span class="pre">get_phylip_symbols</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#teiphy.Collation.get_phylip_symbols" title="Link to this definition"></a></dt>
<dd><p>Returns a list of one-character symbols needed to represent the states of all substantive readings in PHYLIP format.</p>
<p>The number of symbols equals the maximum number of substantive readings at any variation unit.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A list of individual characters representing states in readings.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="teiphy.Collation.get_readings_by_witness_for_unit">
<span class="sig-name descname"><span class="pre">get_readings_by_witness_for_unit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#teiphy.VariationUnit" title="teiphy.variation_unit.VariationUnit"><span class="pre">VariationUnit</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#teiphy.Collation.get_readings_by_witness_for_unit" title="Link to this definition"></a></dt>
<dd><p>Returns a dictionary mapping witness IDs to a list of their reading coefficients for a given variation unit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>vu</strong> – A VariationUnit to be processed.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary mapping witness ID strings to a list of their coefficients for all substantive readings in this VariationUnit.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="teiphy.Collation.get_stemma_symbols">
<span class="sig-name descname"><span class="pre">get_stemma_symbols</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#teiphy.Collation.get_stemma_symbols" title="Link to this definition"></a></dt>
<dd><p>Returns a list of one-character symbols needed to represent the states of all substantive readings in stemma format.</p>
<p>The number of symbols equals the maximum number of substantive readings at any variation unit.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A list of individual characters representing states in readings.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="teiphy.Collation.get_tip_date_range">
<span class="sig-name descname"><span class="pre">get_tip_date_range</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#teiphy.Collation.get_tip_date_range" title="Link to this definition"></a></dt>
<dd><p>Gets the minimum and maximum dates attested among the witnesses.
Also checks if the witness with the latest possible date has a fixed date
(i.e, if the lower and upper bounds for its date are the same)
and issues a warning if not, as this will cause unusual behavior in BEAST 2.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A tuple containing the earliest and latest possible tip dates.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="teiphy.Collation.parse_apps">
<span class="sig-name descname"><span class="pre">parse_apps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xml</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ElementTree</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#teiphy.Collation.parse_apps" title="Link to this definition"></a></dt>
<dd><p>Given an XML tree for a collation, populates its list of variation units from its app elements.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>xml</strong> – An lxml.etree.ElementTree representing an XML tree rooted at a TEI element.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="teiphy.Collation.parse_intrinsic_odds">
<span class="sig-name descname"><span class="pre">parse_intrinsic_odds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xml</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ElementTree</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#teiphy.Collation.parse_intrinsic_odds" title="Link to this definition"></a></dt>
<dd><p>Given an XML tree for a collation, populates this Collation’s list of intrinsic probability categories
(e.g., “absolutely more likely,” “highly more likely,” “more likely,” “slightly more likely,” “equally likely”)
and its dictionary mapping these categories to numerical odds.
If a category does not contain a certainty element specifying its number, then it will be assumed to be a parameter to be estimated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>xml</strong> – An lxml.etree.ElementTree representing an XML tree rooted at a TEI element.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="teiphy.Collation.parse_list_wit">
<span class="sig-name descname"><span class="pre">parse_list_wit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xml</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ElementTree</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#teiphy.Collation.parse_list_wit" title="Link to this definition"></a></dt>
<dd><p>Given an XML tree for a collation, populates its list of witnesses from its listWit element.
If the XML tree does not contain a listWit element, then a ParsingException is thrown listing all distinct witness sigla encountered in the collation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>xml</strong> – An lxml.etree.ElementTree representing an XML tree rooted at a TEI element.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="teiphy.Collation.parse_origin_date_range">
<span class="sig-name descname"><span class="pre">parse_origin_date_range</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xml</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ElementTree</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#teiphy.Collation.parse_origin_date_range" title="Link to this definition"></a></dt>
<dd><p>Given an XML tree for a collation, populates this Collation’s list of origin date bounds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>xml</strong> – An lxml.etree.ElementTree representing an XML tree rooted at a TEI element.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="teiphy.Collation.parse_readings_by_witness">
<span class="sig-name descname"><span class="pre">parse_readings_by_witness</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#teiphy.Collation.parse_readings_by_witness" title="Link to this definition"></a></dt>
<dd><p>Populates the internal dictionary mapping witness IDs to a list of their reading support sets for all variation units, and then fills the empty reading support sets for witnesses of type “corrector” with the entries of the previous witness.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="teiphy.Collation.parse_transcriptional_rates">
<span class="sig-name descname"><span class="pre">parse_transcriptional_rates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xml</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ElementTree</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#teiphy.Collation.parse_transcriptional_rates" title="Link to this definition"></a></dt>
<dd><p>Given an XML tree for a collation, populates this Collation’s dictionary mapping transcriptional change categories
(e.g., “aural confusion,” “visual error,” “clarification”) to numerical rates.
If a category does not contain a certainty element specifying its number, then it will be assumed to be a parameter to be estimated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>xml</strong> – An lxml.etree.ElementTree representing an XML tree rooted at a TEI element.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="teiphy.Collation.parse_weights">
<span class="sig-name descname"><span class="pre">parse_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xml</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ElementTree</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#teiphy.Collation.parse_weights" title="Link to this definition"></a></dt>
<dd><p>Given an XML tree for a collation, populates this Collation’s list of variation unit weight categories
(associated with types of variation that may have different expected frequencies)
and its dictionary mapping these categories to integer weights.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>xml</strong> – An lxml.etree.ElementTree representing an XML tree rooted at a TEI element.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="teiphy.Collation.to_beast">
<span class="sig-name descname"><span class="pre">to_beast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_addr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_constant</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clock_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ClockModel</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">ClockModel.strict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ancestral_logger</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">AncestralLogger</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">AncestralLogger.state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#teiphy.Collation.to_beast" title="Link to this definition"></a></dt>
<dd><p>Writes this Collation to a file in BEAST format with the given address.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_addr</strong> – A string representing the path to an output file.</p></li>
<li><p><strong>drop_constant</strong> (<em>bool</em><em>, </em><em>optional</em>) – An optional flag indicating whether to ignore variation units with one substantive reading.</p></li>
<li><p><strong>clock_model</strong> – A ClockModel option indicating which clock model to use.</p></li>
<li><p><strong>ancestral_logger</strong> – An AncestralLogger option indicating which class of logger (if any) to use for ancestral states.</p></li>
<li><p><strong>seed</strong> – A seed for random number generation (for setting initial values of unspecified transcriptional rates).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="teiphy.Collation.to_csv">
<span class="sig-name descname"><span class="pre">to_csv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_addr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_constant</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ambiguous_as_missing</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proportion</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TableType</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">TableType.matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_missing</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">SplitMissingType</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_ext</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#teiphy.Collation.to_csv" title="Link to this definition"></a></dt>
<dd><p>Writes this Collation to a comma-separated value (CSV) file with the given address.</p>
<p>If your witness IDs are numeric (e.g., Gregory-Aland numbers), then they will be written in full to the CSV file, but Excel will likely interpret them as numbers and truncate any leading zeroes!</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_addr</strong> – A string representing the path to an output CSV file; the file type should be .csv.</p></li>
<li><p><strong>drop_constant</strong> – An optional flag indicating whether to ignore variation units with one substantive reading.
Default value is False.</p></li>
<li><p><strong>ambiguous_as_missing</strong> – An optional flag indicating whether to treat all ambiguous states as missing data.
Default value is False.</p></li>
<li><p><strong>proportion</strong> – An optional flag indicating whether or not to calculate distances as proportions over extant, unambiguous variation units.
Default value is False.</p></li>
<li><p><strong>table_type</strong> – A TableType option indicating which type of tabular output to generate.
Only applicable for tabular outputs.
Default value is “matrix”.</p></li>
<li><p><strong>split_missing</strong> – An option indicating whether or not to treat missing characters/variation units as having a contribution of 1 split over all states/readings.
If not specified, then missing data is ignored (i.e., all states are 0).
If “uniform”, then the contribution of 1 is divided evenly over all substantive readings.
If “proportional”, then the contribution of 1 is divided between the readings in proportion to their support among the witnesses that are not missing.
Only applicable for table types “matrix” and “idf”.</p></li>
<li><p><strong>show_ext</strong> – An optional flag indicating whether each cell in a distance or similarity matrix
should include the number of their extant, unambiguous variation units after the number of their disagreements/agreements.
Only applicable for tabular output formats of type “distance” or “similarity”.
Default value is False.</p></li>
<li><p><strong>**kwargs</strong> – Keyword arguments for pandas.DataFrame.to_csv.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="teiphy.Collation.to_dataframe">
<span class="sig-name descname"><span class="pre">to_dataframe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">drop_constant</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ambiguous_as_missing</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proportion</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TableType</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">TableType.matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_missing</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">SplitMissingType</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_ext</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#teiphy.Collation.to_dataframe" title="Link to this definition"></a></dt>
<dd><p>Returns this Collation in the form of a Pandas DataFrame array, including the appropriate row and column labels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>drop_constant</strong> (<em>bool</em><em>, </em><em>optional</em>) – An optional flag indicating whether to ignore variation units with one substantive reading.
Default value is False.</p></li>
<li><p><strong>ambiguous_as_missing</strong> (<em>bool</em><em>, </em><em>optional</em>) – An optional flag indicating whether to treat all ambiguous states as missing data.
Default value is False.</p></li>
<li><p><strong>proportion</strong> (<em>bool</em><em>, </em><em>optional</em>) – An optional flag indicating whether or not to calculate distances as proportions over extant, unambiguous variation units.
Default value is False.</p></li>
<li><p><strong>table_type</strong> (<em>TableType</em><em>, </em><em>optional</em>) – A TableType option indicating which type of tabular output to generate.
Only applicable for tabular outputs.
Default value is “matrix”.</p></li>
<li><p><strong>split_missing</strong> (<em>SplitMissingType</em><em>, </em><em>optional</em>) – An option indicating whether or not to treat missing characters/variation units as having a contribution of 1 split over all states/readings.
If not specified, then missing data is ignored (i.e., all states are 0).
If “uniform”, then the contribution of 1 is divided evenly over all substantive readings.
If “proportional”, then the contribution of 1 is divided between the readings in proportion to their support among the witnesses that are not missing.
Only applicable for table types “matrix” and “idf”.</p></li>
<li><p><strong>show_ext</strong> – An optional flag indicating whether each cell in a distance or similarity matrix
should include the number of their extant, unambiguous variation units after the number of their disagreements/agreements.
Only applicable for tabular output formats of type “distance” or “similarity”.
Default value is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A Pandas DataFrame corresponding to a collation matrix with reading frequencies or a long table with discrete reading states.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="teiphy.Collation.to_distance_matrix">
<span class="sig-name descname"><span class="pre">to_distance_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">drop_constant</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proportion</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_ext</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#teiphy.Collation.to_distance_matrix" title="Link to this definition"></a></dt>
<dd><p>Transforms this Collation into a NumPy distance matrix between witnesses, along with an array of its labels for the witnesses.
Distances can be computed either as counts of disagreements (the default setting), or as proportions of disagreements over all variation units where both witnesses have singleton readings.
Optionally, the count of units where both witnesses have singleton readings can be included after the count/proportion of disagreements.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>drop_constant</strong> (<em>bool</em><em>, </em><em>optional</em>) – An optional flag indicating whether to ignore variation units with one substantive reading.
Default value is False.</p></li>
<li><p><strong>proportion</strong> (<em>bool</em><em>, </em><em>optional</em>) – An optional flag indicating whether or not to calculate distances as proportions over extant, unambiguous variation units.
Default value is False.</p></li>
<li><p><strong>show_ext</strong> – An optional flag indicating whether each cell in a distance or similarity matrix
should include the number of their extant, unambiguous variation units after the number of their disagreements.
Default value is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A NumPy distance matrix with a row and column for each witness.
A list of witness ID strings.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="teiphy.Collation.to_excel">
<span class="sig-name descname"><span class="pre">to_excel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_addr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_constant</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ambiguous_as_missing</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proportion</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TableType</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">TableType.matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_missing</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">SplitMissingType</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_ext</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#teiphy.Collation.to_excel" title="Link to this definition"></a></dt>
<dd><p>Writes this Collation to an Excel (.xlsx) file with the given address.</p>
<p>Since Pandas is deprecating its support for xlwt, specifying an output in old Excel (.xls) output is not recommended.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_addr</strong> – A string representing the path to an output Excel file; the file type should be .xlsx.</p></li>
<li><p><strong>drop_constant</strong> – An optional flag indicating whether to ignore variation units with one substantive reading.
Default value is False.</p></li>
<li><p><strong>ambiguous_as_missing</strong> – An optional flag indicating whether to treat all ambiguous states as missing data.
Default value is False.</p></li>
<li><p><strong>proportion</strong> – An optional flag indicating whether or not to calculate distances as proportions over extant, unambiguous variation units.
Default value is False.</p></li>
<li><p><strong>table_type</strong> – A TableType option indicating which type of tabular output to generate.
Only applicable for tabular outputs.
Default value is “matrix”.</p></li>
<li><p><strong>split_missing</strong> – An option indicating whether or not to treat missing characters/variation units as having a contribution of 1 split over all states/readings.
If not specified, then missing data is ignored (i.e., all states are 0).
If “uniform”, then the contribution of 1 is divided evenly over all substantive readings.
If “proportional”, then the contribution of 1 is divided between the readings in proportion to their support among the witnesses that are not missing.
Only applicable for table types “matrix” and “idf”.</p></li>
<li><p><strong>show_ext</strong> – An optional flag indicating whether each cell in a distance or similarity matrix
should include the number of their extant, unambiguous variation units after the number of their disagreements/agreements.
Only applicable for tabular output formats of type “distance” or “similarity”.
Default value is False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="teiphy.Collation.to_fasta">
<span class="sig-name descname"><span class="pre">to_fasta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_addr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_constant</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#teiphy.Collation.to_fasta" title="Link to this definition"></a></dt>
<dd><p>Writes this Collation to a file in FASTA format with the given address.
Note that because FASTA format does not support NEXUS-style ambiguities, such ambiguities will be treated as missing data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_addr</strong> – A string representing the path to an output file.</p></li>
<li><p><strong>drop_constant</strong> (<em>bool</em><em>, </em><em>optional</em>) – An optional flag indicating whether to ignore variation units with one substantive reading.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="teiphy.Collation.to_file">
<span class="sig-name descname"><span class="pre">to_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_addr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Format</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_constant</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_missing</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">SplitMissingType</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">char_state_labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frequency</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ambiguous_as_missing</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proportion</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calibrate_dates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mrbayes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clock_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ClockModel</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">ClockModel.strict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ancestral_logger</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">AncestralLogger</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">AncestralLogger.state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TableType</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">TableType.matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_ext</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#teiphy.Collation.to_file" title="Link to this definition"></a></dt>
<dd><p>Writes this Collation to the file with the given address.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_addr</strong> (<em>Union</em><em>[</em><em>Path</em><em>, </em><em>str</em><em>]</em>) – The path to the output file.</p></li>
<li><p><strong>format</strong> (<em>Format</em><em>, </em><em>optional</em>) – The desired output format.
If None then it is infered from the file suffix.
Defaults to None.</p></li>
<li><p><strong>drop_constant</strong> (<em>bool</em><em>, </em><em>optional</em>) – An optional flag indicating whether to ignore variation units with one substantive reading.
Default value is False.</p></li>
<li><p><strong>split_missing</strong> (<em>SplitMissingType</em><em>, </em><em>optional</em>) – An option indicating whether or not to treat missing characters/variation units as having a contribution of 1 split over all states/readings.
If not specified, then missing data is ignored (i.e., all states are 0).
If “uniform”, then the contribution of 1 is divided evenly over all substantive readings.
If “proportional”, then the contribution of 1 is divided between the readings in proportion to their support among the witnesses that are not missing.
Only applicable for tabular outputs of type “matrix” or “idf”.</p></li>
<li><p><strong>char_state_labels</strong> (<em>bool</em><em>, </em><em>optional</em>) – An optional flag indicating whether to print
the CharStateLabels block in NEXUS output.
Default value is True.</p></li>
<li><p><strong>frequency</strong> (<em>bool</em><em>, </em><em>optional</em>) – An optional flag indicating whether to use the StatesFormat=Frequency setting
instead of the StatesFormat=StatesPresent setting
(and thus represent all states with frequency vectors rather than symbols)
in NEXUS output.
Note that this setting is necessary to make use of certainty degrees assigned to multiple ambiguous states in the collation.
Default value is False.</p></li>
<li><p><strong>ambiguous_as_missing</strong> (<em>bool</em><em>, </em><em>optional</em>) – An optional flag indicating whether to treat all ambiguous states as missing data.
If this flag is set, then only base symbols will be generated for the NEXUS file.
It is only applied if the frequency option is False.
Default value is False.</p></li>
<li><p><strong>proportion</strong> (<em>bool</em><em>, </em><em>optional</em>) – An optional flag indicating whether to populate a distance matrix’s cells
with a proportion of disagreements to variation units where both witnesses are extant.
It is only applied if the table_type option is “distance”.
Default value is False.</p></li>
<li><p><strong>calibrate_dates</strong> (<em>bool</em><em>, </em><em>optional</em>) – An optional flag indicating whether to add an Assumptions block that specifies date distributions for witnesses
in NEXUS output.
This option is intended for inputs to BEAST 2.
Default value is False.</p></li>
<li><p><strong>mrbayes</strong> (<em>bool</em><em>, </em><em>optional</em>) – An optional flag indicating whether to add a MrBayes block that specifies model settings and age calibrations for witnesses
in NEXUS output.
This option is intended for inputs to MrBayes.
Default value is False.</p></li>
<li><p><strong>clock_model</strong> (<em>ClockModel</em><em>, </em><em>optional</em>) – A ClockModel option indicating which type of clock model to use.
This option is intended for inputs to MrBayes and BEAST 2.
MrBayes does not presently support a local clock model, so it will default to a strict clock model if a local clock model is specified.
Default value is “strict”.</p></li>
<li><p><strong>ancestral_logger</strong> (<em>AncestralLogger</em><em>, </em><em>optional</em>) – An AncestralLogger option indicating which class of logger (if any) to use for ancestral states.
This option is intended for inputs to BEAST 2.</p></li>
<li><p><strong>table_type</strong> (<em>TableType</em><em>, </em><em>optional</em>) – A TableType option indicating which type of tabular output to generate.
Only applicable for tabular outputs and PHYLIP outputs.
If the output is a PHYLIP file, then the type of tabular output must be “distance” or “similarity”; otherwise, it will be ignored.
Default value is “matrix”.</p></li>
<li><p><strong>show_ext</strong> (<em>bool</em><em>, </em><em>optional</em>) – An optional flag indicating whether each cell in a distance or similarity matrix
should include the number of variation units where both witnesses are extant after the number of their disagreements/agreements.
Only applicable for tabular output formats of type “distance” or “similarity”.
Default value is False.</p></li>
<li><p><strong>seed</strong> (<em>optional</em><em>, </em><em>int</em>) – A seed for random number generation (for setting initial values of unspecified transcriptional rates in BEAST 2 XML output).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="teiphy.Collation.to_hennig86">
<span class="sig-name descname"><span class="pre">to_hennig86</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_addr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_constant</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#teiphy.Collation.to_hennig86" title="Link to this definition"></a></dt>
<dd><p>Writes this Collation to a file in Hennig86 format with the given address.
Note that because Hennig86 format does not support NEXUS-style ambiguities, such ambiguities will be treated as missing data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_addr</strong> – A string representing the path to an output file.</p></li>
<li><p><strong>drop_constant</strong> (<em>bool</em><em>, </em><em>optional</em>) – An optional flag indicating whether to ignore variation units with one substantive reading.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="teiphy.Collation.to_idf_matrix">
<span class="sig-name descname"><span class="pre">to_idf_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">drop_constant</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_missing</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">SplitMissingType</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#teiphy.Collation.to_idf_matrix" title="Link to this definition"></a></dt>
<dd><p>Transforms this Collation into a NumPy inverse document frequency-weighted agreements matrix between witnesses, along with an array of its labels for the witnesses.
The IDF weight of an agreement on a given reading is the information content -log(Pr(R)) of the event R of randomly sampling a witness with that reading.
The IDF-weighted agreement score for two witnesses is the sum of the IDF weights for the readings at which they agree.
Where any witness is lacunose or ambiguous, it contributes to its potential readings’ sampling probabilities in proportion to its degrees of support for those readings.
Similarly, where one or both target witnesses are lacunose or ambiguous, the expected information content of their agreement is calculated based on the probabilities of their having the same reading.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>drop_constant</strong> (<em>bool</em><em>, </em><em>optional</em>) – An optional flag indicating whether to ignore variation units with one substantive reading.
Default value is False.</p></li>
<li><p><strong>split_missing</strong> (<em>SplitMissingType</em><em>, </em><em>optional</em>) – An option indicating whether or not to treat missing characters/variation units as having a contribution of 1 split over all states/readings.
If not specified, then missing data is ignored (i.e., all states are 0).
If “uniform”, then the contribution of 1 is divided evenly over all substantive readings.
If “proportional”, then the contribution of 1 is divided between the readings in proportion to their support among the witnesses that are not missing.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A NumPy IDF-weighted agreement matrix with a row and column for each witness.
A list of witness ID strings.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="teiphy.Collation.to_long_table">
<span class="sig-name descname"><span class="pre">to_long_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">drop_constant</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#teiphy.Collation.to_long_table" title="Link to this definition"></a></dt>
<dd><p>Returns this Collation in the form of a long table with columns for taxa, characters, reading indices, and reading values.
Note that this method treats ambiguous readings as missing data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>drop_constant</strong> (<em>bool</em><em>, </em><em>optional</em>) – An optional flag indicating whether to ignore variation units with one substantive reading.
Default value is False.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A NumPy array with columns for taxa, characters, reading indices, and reading values, and rows for each combination of these values in the matrix.
A list of column label strings.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="teiphy.Collation.to_nexus">
<span class="sig-name descname"><span class="pre">to_nexus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_addr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_constant</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">char_state_labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frequency</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ambiguous_as_missing</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calibrate_dates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mrbayes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clock_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ClockModel</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">ClockModel.strict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#teiphy.Collation.to_nexus" title="Link to this definition"></a></dt>
<dd><p>Writes this Collation to a NEXUS file with the given address.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_addr</strong> – A string representing the path to an output NEXUS file; the file type should be .nex, .nexus, or .nxs.</p></li>
<li><p><strong>drop_constant</strong> – An optional flag indicating whether to ignore variation units with one substantive reading.</p></li>
<li><p><strong>char_state_labels</strong> – An optional flag indicating whether or not to include the CharStateLabels block.</p></li>
<li><p><strong>frequency</strong> – An optional flag indicating whether to use the StatesFormat=Frequency setting
instead of the StatesFormat=StatesPresent setting
(and thus represent all states with frequency vectors rather than symbols).
Note that this setting is necessary to make use of certainty degrees assigned to multiple ambiguous states in the collation.</p></li>
<li><p><strong>ambiguous_as_missing</strong> – An optional flag indicating whether to treat all ambiguous states as missing data.
If this flag is set, then only base symbols will be generated for the NEXUS file.
It is only applied if the frequency option is False.</p></li>
<li><p><strong>calibrate_dates</strong> – An optional flag indicating whether to add an Assumptions block that specifies date distributions for witnesses.
This option is intended for inputs to BEAST 2.</p></li>
<li><p><strong>mrbayes</strong> – An optional flag indicating whether to add a MrBayes block that specifies model settings and age calibrations for witnesses.
This option is intended for inputs to MrBayes.</p></li>
<li><p><strong>clock_model</strong> – A ClockModel option indicating which type of clock model to use.
This option is intended for inputs to MrBayes and BEAST 2.
MrBayes does not presently support a local clock model, so it will default to a strict clock model if a local clock model is specified.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="teiphy.Collation.to_nexus_table">
<span class="sig-name descname"><span class="pre">to_nexus_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">drop_constant</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ambiguous_as_missing</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#teiphy.Collation.to_nexus_table" title="Link to this definition"></a></dt>
<dd><p>Returns this Collation in the form of a table with rows for taxa, columns for characters, and reading IDs in cells.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>drop_constant</strong> (<em>bool</em><em>, </em><em>optional</em>) – An optional flag indicating whether to ignore variation units with one substantive reading.
Default value is False.</p></li>
<li><p><strong>ambiguous_as_missing</strong> (<em>bool</em><em>, </em><em>optional</em>) – An optional flag indicating whether to treat all ambiguous states as missing data.
Default value is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A NumPy array with rows for taxa, columns for characters, and reading IDs in cells.
A list of substantive reading ID strings.
A list of witness ID strings.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="teiphy.Collation.to_numpy">
<span class="sig-name descname"><span class="pre">to_numpy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">drop_constant</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_missing</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">SplitMissingType</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#teiphy.Collation.to_numpy" title="Link to this definition"></a></dt>
<dd><p>Returns this Collation in the form of a NumPy array, along with arrays of its row and column labels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>drop_constant</strong> (<em>bool</em><em>, </em><em>optional</em>) – An optional flag indicating whether to ignore variation units with one substantive reading.</p></li>
<li><p><strong>split_missing</strong> (<em>SplitMissingType</em><em>, </em><em>optional</em>) – An option indicating whether or not to treat missing characters/variation units as having a contribution of 1 split over all states/readings.
If not specified, then missing data is ignored (i.e., all states are 0).
If “uniform”, then the contribution of 1 is divided evenly over all substantive readings.
If “proportional”, then the contribution of 1 is divided between the readings in proportion to their support among the witnesses that are not missing.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A NumPy array with a row for each substantive reading and a column for each witness.
A list of substantive reading ID strings.
A list of witness ID strings.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="teiphy.Collation.to_phylip">
<span class="sig-name descname"><span class="pre">to_phylip</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_addr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_constant</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#teiphy.Collation.to_phylip" title="Link to this definition"></a></dt>
<dd><p>Writes this Collation to a file in PHYLIP format with the given address.
Note that because PHYLIP format does not support NEXUS-style ambiguities, such ambiguities will be treated as missing data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_addr</strong> – A string representing the path to an output file.</p></li>
<li><p><strong>drop_constant</strong> (<em>bool</em><em>, </em><em>optional</em>) – An optional flag indicating whether to ignore variation units with one substantive reading.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="teiphy.Collation.to_phylip_matrix">
<span class="sig-name descname"><span class="pre">to_phylip_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_addr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_constant</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proportion</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TableType</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">TableType.distance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_ext</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#teiphy.Collation.to_phylip_matrix" title="Link to this definition"></a></dt>
<dd><p>Writes this Collation as a PHYLIP-formatted distance/similarity matrix to the file with the given address.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_addr</strong> – A string representing the path to an output PHYLIP file; the file type should be .ph or .phy.</p></li>
<li><p><strong>drop_constant</strong> – An optional flag indicating whether to ignore variation units with one substantive reading.
Default value is False.</p></li>
<li><p><strong>proportion</strong> – An optional flag indicating whether or not to calculate distances as proportions over extant, unambiguous variation units.
Default value is False.</p></li>
<li><p><strong>table_type</strong> – A TableType option indicating which type of tabular output to generate.
For PHYLIP-formatted outputs, distance and similarity matrices are the only supported table types.
Default value is “distance”.</p></li>
<li><p><strong>show_ext</strong> – An optional flag indicating whether each cell in a distance or similarity matrix
should include the number of their extant, unambiguous variation units after the number of their disagreements/agreements.
Only applicable for tabular output formats of type “distance” or “similarity”.
Default value is False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="teiphy.Collation.to_similarity_matrix">
<span class="sig-name descname"><span class="pre">to_similarity_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">drop_constant</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proportion</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_ext</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#teiphy.Collation.to_similarity_matrix" title="Link to this definition"></a></dt>
<dd><p>Transforms this Collation into a NumPy similarity matrix between witnesses, along with an array of its labels for the witnesses.
Similarities can be computed either as counts of agreements (the default setting), or as proportions of agreements over all variation units where both witnesses have singleton readings.
Optionally, the count of units where both witnesses have singleton readings can be included after the count/proportion of agreements.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>drop_constant</strong> (<em>bool</em><em>, </em><em>optional</em>) – An optional flag indicating whether to ignore variation units with one substantive reading.
Default value is False.</p></li>
<li><p><strong>proportion</strong> (<em>bool</em><em>, </em><em>optional</em>) – An optional flag indicating whether or not to calculate similarities as proportions over extant, unambiguous variation units.
Default value is False.</p></li>
<li><p><strong>show_ext</strong> – An optional flag indicating whether each cell in a distance or similarity matrix
should include the number of their extant, unambiguous variation units after the number of agreements.
Default value is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A NumPy agreement matrix with a row and column for each witness.
A list of witness ID strings.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="teiphy.Collation.to_stemma">
<span class="sig-name descname"><span class="pre">to_stemma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_addr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#teiphy.Collation.to_stemma" title="Link to this definition"></a></dt>
<dd><p>Writes this Collation to a stemma file without an extension and a Chron file (containing low, middle, and high dates for all witnesses) without an extension.</p>
<p>Since this format does not support ambiguous states, all reading vectors with anything other than one nonzero entry will be interpreted as lacunose.
If an interpGrp for weights is specified in the TEI XML collation, then the weights for the interp elements will be used as weights
for the variation units that specify them in their ana attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_addr</strong> – A string representing the path to an output stemma prep file; the file should have no extension.</p></li>
<li><p><strong>name</strong> (<em>The accompanying chron file will match this file</em>)</p></li>
<li><p><strong>end.</strong> (<em>except that it will have &quot;_chron&quot; appended to the</em>)</p></li>
<li><p><strong>drop_constant</strong> – An optional flag indicating whether to ignore variation units with one substantive reading.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="teiphy.Collation.update_origin_date_range_from_witness_date_ranges">
<span class="sig-name descname"><span class="pre">update_origin_date_range_from_witness_date_ranges</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#teiphy.Collation.update_origin_date_range_from_witness_date_ranges" title="Link to this definition"></a></dt>
<dd><p>Conditionally updates the upper bound on the date of origin of the work represented by this Collation
based on the bounds on the witnesses’ dates.
If none of the witnesses have bounds on their dates, then nothing is done.
This method is only invoked if the work’s date of origin does not already have its upper bound defined.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="teiphy.Collation.update_witness_date_ranges_from_dates_file">
<span class="sig-name descname"><span class="pre">update_witness_date_ranges_from_dates_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dates_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#teiphy.Collation.update_witness_date_ranges_from_dates_file" title="Link to this definition"></a></dt>
<dd><p>Given a CSV-formatted dates file, update the date ranges of all witnesses whose IDs are in the first column of the dates file
(overwriting existing date ranges if necessary).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="teiphy.Collation.update_witness_date_ranges_from_origin_date_range">
<span class="sig-name descname"><span class="pre">update_witness_date_ranges_from_origin_date_range</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#teiphy.Collation.update_witness_date_ranges_from_origin_date_range" title="Link to this definition"></a></dt>
<dd><p>Attempts to update the lower bounds on the witnesses’ dates of origin of the work represented by this Collation
using the upper bound on the date of origin of the work represented by this Collation.
This method is only invoked if the upper bound on the work’s date of origin was not already defined
(i.e., if update_origin_date_range_from_witness_date_ranges was not invoked).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="teiphy.Collation.validate_intrinsic_relations">
<span class="sig-name descname"><span class="pre">validate_intrinsic_relations</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#teiphy.Collation.validate_intrinsic_relations" title="Link to this definition"></a></dt>
<dd><p>Checks if any VariationUnit’s intrinsic_relations map is not a forest.
If any is not, then an IntrinsicRelationsException is thrown describing the VariationUnit at fault.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="teiphy.Collation.validate_wits">
<span class="sig-name descname"><span class="pre">validate_wits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xml</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ElementTree</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#teiphy.Collation.validate_wits" title="Link to this definition"></a></dt>
<dd><p>Given an XML tree for a collation, checks if any witness sigla listed in a rdg, rdgGrp, or witDetail element,
once stripped of ignored suffixes, is not found in the witness list.
A warning will be issued for each distinct siglum like this.
This method also checks if the upper bound of any witness’s date is earlier than the lower bound on the collated work’s date of origin
and throws an exception if so.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>xml</strong> – An lxml.etree.ElementTree representing an XML tree rooted at a TEI element.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="variation-unit">
<h2>Variation Unit<a class="headerlink" href="#variation-unit" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="teiphy.VariationUnit">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">teiphy.</span></span><span class="sig-name descname"><span class="pre">VariationUnit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xml</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Element</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#teiphy.VariationUnit" title="Link to this definition"></a></dt>
<dd><p>Base class for storing TEI XML variation unit data internally.</p>
<p>This corresponds to an app element in the collation.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="teiphy.VariationUnit.id">
<span class="sig-name descname"><span class="pre">id</span></span><a class="headerlink" href="#teiphy.VariationUnit.id" title="Link to this definition"></a></dt>
<dd><p>The ID string of this variation unit, which should be unique.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="teiphy.VariationUnit.readings">
<span class="sig-name descname"><span class="pre">readings</span></span><a class="headerlink" href="#teiphy.VariationUnit.readings" title="Link to this definition"></a></dt>
<dd><p>A list of Readings contained in this VariationUnit.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="teiphy.VariationUnit.intrinsic_relations">
<span class="sig-name descname"><span class="pre">intrinsic_relations</span></span><a class="headerlink" href="#teiphy.VariationUnit.intrinsic_relations" title="Link to this definition"></a></dt>
<dd><p>A dictionary mapping pairs of IDs of Readings in this VariationUnit to the intrinsic odds category</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">describing</span> <span class="pre">the</span> <span class="pre">two</span> <span class="pre">readings'</span> <span class="pre">relative</span> <span class="pre">probability</span> <span class="pre">of</span> <span class="pre">being</span> <span class="pre">authorial.</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="teiphy.VariationUnit.transcriptional_relations">
<span class="sig-name descname"><span class="pre">transcriptional_relations</span></span><a class="headerlink" href="#teiphy.VariationUnit.transcriptional_relations" title="Link to this definition"></a></dt>
<dd><p>A dictionary mapping pairs of IDs of Readings in this VariationUnit to a set of transcriptional change categories</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">that</span> <span class="pre">could</span> <span class="pre">explain</span> <span class="pre">the</span> <span class="pre">rise</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">second</span> <span class="pre">reading</span> <span class="pre">from</span> <span class="pre">the</span> <span class="pre">first.</span></span></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="teiphy.VariationUnit.parse">
<span class="sig-name descname"><span class="pre">parse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xml</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Element</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#teiphy.VariationUnit.parse" title="Link to this definition"></a></dt>
<dd><p>Given an XML element, recursively parses its subelements for readings, reading groups, and witness details.</p>
<p>Other children of app elements, such as note, noteGrp, and wit elements, are ignored.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xml</strong> – An lxml.etree.Element representing an app element.</p></li>
<li><p><strong>verbose</strong> – An optional boolean flag indicating whether or not to print status updates.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="witness">
<h2>Witness<a class="headerlink" href="#witness" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="teiphy.Witness">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">teiphy.</span></span><span class="sig-name descname"><span class="pre">Witness</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xml</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Element</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#teiphy.Witness" title="Link to this definition"></a></dt>
<dd><p>Base class for storing TEI XML witness data internally.</p>
<p>This corresponds to a witness element in the collation.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="teiphy.Witness.id">
<span class="sig-name descname"><span class="pre">id</span></span><a class="headerlink" href="#teiphy.Witness.id" title="Link to this definition"></a></dt>
<dd><p>The ID string of this Witness. It should be unique.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="teiphy.Witness.type">
<span class="sig-name descname"><span class="pre">type</span></span><a class="headerlink" href="#teiphy.Witness.type" title="Link to this definition"></a></dt>
<dd><p>A string representing the type of witness. Examples include “corrector”, “version”, and “father”.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="teiphy.Witness.date_range">
<span class="sig-name descname"><span class="pre">date_range</span></span><a class="headerlink" href="#teiphy.Witness.date_range" title="Link to this definition"></a></dt>
<dd><p>A list containing a low and high date for this Witness.</p>
</dd></dl>

</dd></dl>

</section>
<section id="reading">
<h2>Reading<a class="headerlink" href="#reading" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="teiphy.Reading">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">teiphy.</span></span><span class="sig-name descname"><span class="pre">Reading</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xml</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Element</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#teiphy.Reading" title="Link to this definition"></a></dt>
<dd><p>Base class for storing TEI XML reading data internally.</p>
<p>This can correspond to a lem, rdg, or witDetail element in the collation.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="teiphy.Reading.id">
<span class="sig-name descname"><span class="pre">id</span></span><a class="headerlink" href="#teiphy.Reading.id" title="Link to this definition"></a></dt>
<dd><p>The ID string of this reading, which should be unique within its parent app element.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="teiphy.Reading.type">
<span class="sig-name descname"><span class="pre">type</span></span><a class="headerlink" href="#teiphy.Reading.type" title="Link to this definition"></a></dt>
<dd><p>A string representing the type of reading. Examples include “reconstructed”, “defective”, “orthographic”, “subreading”, “ambiguous”, “overlap”, and “lac”. The default value is “substantive”.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="teiphy.Reading.text">
<span class="sig-name descname"><span class="pre">text</span></span><a class="headerlink" href="#teiphy.Reading.text" title="Link to this definition"></a></dt>
<dd><p>Serialization of the contents of this element.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="teiphy.Reading.wits">
<span class="sig-name descname"><span class="pre">wits</span></span><a class="headerlink" href="#teiphy.Reading.wits" title="Link to this definition"></a></dt>
<dd><p>A list of sigla referring to witnesses that support this reading.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="teiphy.Reading.targets">
<span class="sig-name descname"><span class="pre">targets</span></span><a class="headerlink" href="#teiphy.Reading.targets" title="Link to this definition"></a></dt>
<dd><p>A list of other reading ID strings to which this reading corresponds. For substantive readings, this should be empty. For ambiguous readings, it should contain references to the readings that might correspond to this one. For overlap readings, it should contain a reference to the reading from the overlapping variation unit responsible for the overlap.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="teiphy.Reading.certainties">
<span class="sig-name descname"><span class="pre">certainties</span></span><a class="headerlink" href="#teiphy.Reading.certainties" title="Link to this definition"></a></dt>
<dd><p>A dictionary mapping target reading IDs to floating-point certainty values.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="teiphy.Reading.parse">
<span class="sig-name descname"><span class="pre">parse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xml</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Element</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#teiphy.Reading.parse" title="Link to this definition"></a></dt>
<dd><p>Given an XML element, recursively parses it and its subelements.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xml</strong> – A lem, rdg, or witDetail element.</p></li>
<li><p><strong>verbose</strong> – An optional flag indicating whether or not to print status updates.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="example.html" class="btn btn-neutral float-left" title="Example" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="cli.html" class="btn btn-neutral float-right" title="Command Line Interface Reference" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Joey McCollum and Robert Turnbull.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>